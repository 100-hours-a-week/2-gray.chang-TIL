<img src="/Tracking_Time/3_Mar/250326.png">

영속성 컨텍스트란? 엔티티를 영구 저장하는 환경
- 논리적인 개념이고, entityManager를 통해 접근한다.
- 일반적으로 쓰는 공부환경에서는 엔티티메니저와 영속성 컨텍스트가 1:1이지만, 스프링 프레임워크로 넘어가면 N:1이 된다.
- 엔티티 생명주기 : 비영속, 영속, 준영속, 삭제

더티체킹 : 변경감지
- 시기 : em.flush() 또는 트랜잭션 종료 시점
- 1차캐시에 저장된 엔티티의 초기 스냅샷과 현재 상태를 비교하여 변경된 항목에 대해 update 쿼리를 생성하여 쓰기지연 SQL저장소에 등록 후 한꺼번에 데이터베이스에 전송
- 그래서 별도의 update 메서드는 작성할 필요가 없다
- 만약 중간에 JPQL을 실행시킨다면 플러시 후 쿼리가 실행된다.(기본값, option을 commit으로 바꾸면 커밋할때만 플러시가 일어남)

준영속상태
- 영속 상태의 엔티티가 영속성 컨텍스트에서 분리되는 것
- 영속성 컨텍스트에서 제공되는 기능(dirty checking 등)을 제공받지 못함
- detach, clear, close
