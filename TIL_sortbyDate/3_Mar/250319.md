<img src="/Tracking_Time/3_Mar/250319.png">

### N+1 문제란?
* JPA에서 발생하는 고질적인 문제
* 연관관계의 테이블(엔티티)에 1번의 쿼리를 날렸을 때 N번의 불필요한 쿼리가 추가로 실행되는 현상(read)
* 발생하는 상황
  * ManyToOne이나 OneToMany 관계의 엔티티를 조회할 때 발생
  * JPA Fetch 전략으로 EAGER 전략을 사용하여 데이터를 조회하는 경우
  * JPA Fetch 전략으로 LAZY 전략을 사용하여 데이터를 조회하고 추가로 하위 엔티티를 조회할 경우
* 발생하는 이유
  * JPA repository는 find 실행 시 하위 엔티티까지 한번에 가져오지 않기 때문
* 해결책
  * Fetch Join : JPQL에서 제공하는 조회 함수, 연관된 엔티티를 한번에 조회하는 기능
    * n+1 문제가 발생하는 이유는 연관관계의 엔티티를 따로따로 조회하기 때문이므로, 한번에 가져오면 문제가 발생하지 않는다!
    * inner join처럼 동작함
      * inner join과의 차이점 : inner join은 JPQL에서 조회하는 주체가 되는 엔티티만 영속화하고, fetch join은 주체 엔티티 뿐만 아니라 연관관계의 모든 엔티티를 함께 select하여 영속화한다.
    * 단점
      * PagingAPI 사용 불가능
      * 쿼리문 불필요하게 작성해야 함
      * 1:N관계가 두개 이상일 경우 사용 불가
  * @EntityGraph
    * 같이 조회할 연관 엔티티명을 명시하여 어노테이션으로 추가
    * left outer join